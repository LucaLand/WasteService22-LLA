<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="it">


<head>
    <title>Iss2023-LLA-Sprint1</title>
    <link href="./defaultStyle.css" rel="stylesheet">
	<link href="./menuCss.css" rel="stylesheet">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> <!--  To solve accent problems  -->
</head>


<body>
<div id="top">
    <h1>Progetto Finale ISS - Waste Service</h1>
</div>
<div class="remark">
<nav>
    <ul>
        <li><a href="../../Sprint-0/userDocs/Sprint0-LLA.html">sprint0</a></li>
        <li><a href="./Sprint1-LLA.html">sprint1</a></li>
    </ul>
</nav>
</div>

    <h2>Introduction</h2>
    <div class="remark">
	<p>
	Progetto finale di ISS che consiste nel realizzare un sistema di gestione dei rifiuti in cui un robot svolge il compito di trasportare i materiali dal camion ai relativi contenitori di smistamento. 
	Attualmente, ci concentriamo su una fase preliminare di analisi dei requisiti, che consiste nel comprendere le esigenze del cliente e tradurle in una forma formalizzata e strutturata.
	</p>
	</div>

    <h2>Requirements</h2>
    <div class="remark">
        <p>Si riporta la pagina di requisiti del committente: <a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2022/blob/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/TemaFinale22.html" traget="_blank" >Waste
            Service 22.pdf</a></p>
		<p>Inoltre si riporta il file dei requisiti dello Sprint0: <a href="../../Sprint-0/userDocs/Sprint0-LLA.html#Requirements">Requisiti Sprint0</a>
    </div>

    <!----------------------- REQUIREMENT ANALYSIS --------------------------->

    <h2>Scrum Goal and Work Plan</h2>
    <div class="remark">
	<h4>Scrum goal:</h4>
	Obiettivo dello Sprint1 è la creazione di una prima demo (su ambiente virtuale) che tenga presente delle richiesete del commitente, ossia che il truck vada via il prima possibile 
	e che il sistema possa ricevere altre richieste anche durante la fase di deposito dei rifiuti. Questi, di fatto, sono i punti principali che contengono la core business logic del problema (descrivono
	infatti la <b>Service area</b> e la <b>Deposit action</b>).
	
	<h4>Work plan:</h4>
	<ul>
        <li>Analisi del problema di come affrontare la navigazione, anche in relazione al SW già sviluppato <br>
            (possibile visitare la pagina riassuntiva <a href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2022/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/Applicazioni22.html">Applicazioni22</a> dei moduli sviluppati)</li>
        <li>Analisi delle responsabilità e delle interazioni tra i componenti <i>wasteservice</i>, <i>trasporttrolley</i> e <i>basicrobot</i></li>
        <li>Sviluppo / adattamento di tali componenti</li>
        <li>Realizzazione di un modello eseguibile (a tal proposito verrà utilizzato il metamodello <a href="../../Sprint-0/userDocs/QAK.html">QAK</a>).</li>
        <li>Realizzazione di un (più completo) test-plan per il modello</li>
    </ul>
        
    </div>
	
	<!--PROBLEM ANALYSIS-->
	<a NAME="ProblemAnalysis"></a>
	<h2>Problem analysis</h2>
	<div class="remark">
        <div class="remark remark2">
            <h4>Architettura logica precedente:</h4>
            <img src="img/LogicalArch_R2.png" alt="General Logical Architecture" style="width: 600px;" >
            <p style="width: 100%; text-align: right;"><a href="./img/Legenda.png">Legenda.png</a></p>
            <br>

            <h4>Focus Sprint-1</h4>
            <p>Focus Sprint-1</p>
            <img src="img/Spint-1_Focus_Initial.png" alt="Architecture Focus Sprint-1" style="width: 80%">
        </div>






        <h3>1 - Simulazione Smart Device</h3>
		<p>
		
		Come da requisiti, lo <b>Smart Device</b> non dovrà essere implementato. Per facilitare la messa appunto dell'applicazione introduciamo un <b><i>Mock-object</i></b>, 
		cioè un dispositivo simulato che riproduce il comportamento dei dispositivi reali in modo controllato, in questo caso verrà utilizzato per la simulazione dello <b>Smart Device</b>.
		Questo meccanismo ci consente di andare a simulare l'interazione tra lo <b>Smart Device</b> e il <b>WasteService</b>, in particolare il primo invierà una <i>DepositRequest</i>
		e si metterà in attesa di una risposta.
		</br>
		</br>
		Di seguito viene riportata la documentazione relativa ai <b><i>Mock-object</i></b>: <a href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2022/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/RadarSystemProgetto.html#sprint1-componenti-per-i-dispositivi-di-i-o"> Mock
		</a>
		
		
		</p>

        <h3>2 - Analisi della Core Business Logic </h3>
        <p>In questa sezione iniziamo con il delineare una prima organizzazione della <i>Logica di Business</i> dei <i>Core Components</i>.</p>
        <ul>
            <li>SmartDevice</li>
            <li><b>WasteService</b></li>
            <li><b>Transport Trolley</b></li>
            <li>BasicRobot22</li>
        </ul>
        <p>Per quanto riguarda lo <code><i>SmartDevice</i></code> e il <code><i>BasicRobot22</i></code> sono già stati definiti precedentemente per quello non verranno analizzati.</p>
        <h4>Macro analisi delle funzionalità:</h4> <!-- e divisione dei compiti tra i componenti:</p> -->
        <ol>
            <li>Il <b>WasteService</b> prende le richieste dello <i>SmartDevice</i> e in base alla capienza dei Box le accetta o rifiuta.</li>
            <li>Il <b>WasteServcie</b> comunica con il <b>Transport Trolley</b> richiedendo il <i>PickUp</i> dei rifiuti dal camion e lo scarico degli stessi in un determinato tipo di Box, in caso di richieste accettate.</li>
            <li>Il <b>Transport Trolley</b> gestirà le richieste di <i>pickUp</i> del <b>WasteService</b> inviando comandi per muovere il <b>BasicRobot22</b> per raggiungere le posizioni desiderate.</li>
            <li>Il <b>Transport Trolley</b> prevede l'invio di una conferma di <i>PickUp</i> al <b>WasteService</b> non appena avrà terminato il <i>pickUp</i>.</li>
            <li>Il <b>Transport Trolley</b> deve prevedere la gestione di richieste di scarico mentre sta ancora eseguendo una <i>Deposit Action</i>.</li>
        </ol>



        <h3>3 - Gestione delle richieste</h3>
		<p>
		Il <b>WasteService</b> per poter gestire le richieste che arrivano dallo <b>Smart Device</b> si avvale dell'utilizzo di due variabili inizializzate nello 
		<a href="../../Sprint-0/userDocs/Sprint0-LLA.html#Variables">Sprint0</a>.
		Le variabili contGB e contPB, inizializzate nello Sprint0, sono rispettivamente delle variabili contatori per i due tipi di materiali da depositare e verranno verificate 
		con la capienza massima dei box stabilita a priori tramite i valori di MAXGB e MAXPB.
		   <pre><code>
Request depositRequest	: 	depositRequest(TYPE, TRUCKLOAD, ...)
Reply loadaccept	: 	loadaccept(...)
Reply loadrejecetd	: 	loadrejecetd(...)

if(contGB OR  contPB + TRUCKLOAD) > MAXGB OR MAXPB{
Reply loadrejecetd 
}
else{
Reply loadaccept
}
            </code></pre>
		
		
		</p>


        <h3>4 - Interazione WasteService e TransportTrolley</h3>
<p>Il <b>WasteService</b>, una volta gestita positivamente la richiesta che arriva dallo <b>Smart Device</b>, agisce in maniera sequenziale verso il <b>Transport Trolley</b> mandando una request di Pickup
del carico trasportato dal <b>WasteTruck</b>. Il <b>WasteService</b> sarà abilitato anche a ricevere una reply da parte del <b>TransportTrolley</b> che sancisce la fine dell'azione di 
carico e permette al <b>WasteService</b> di mandare via il <b>WasteTruck</b> il prima possibile.
Se la richiesta di scarico viene rifiutata, il <b>WasteService</b> resta in attesa per nuove richieste, anche se il trolley sta ancora depositando.

		   <pre><code>
Request PickupReq	:	PickupReq(...)
Reply   PickupOK	:	PickupOk(...)


State requestRejected {
	replyTo depositRequest with loadrejecetd : loadrejecetd($ID)
	println("\t $name: Request -$ID- Refused!") color green
}
Goto waiting

State pickingUp {
	println("\t $name: Request -$ID- Accepted!") color green
	println("\t $name: Picking Up...") color green
	delay 7000
}
Goto pickupOk

State pickupOk {
	println("\t $name: PickupOK received! Truck ${payloadArg(0)} can go away!") color green
	replyTo depositRequest with loadaccept : loadaccept($ID)
	println("Depositing waste...")
}
Goto waiting
//Ritorna a Waiting per attendere nuove richieste, anche se il trolley sta ancora depositando
}
            </code></pre>


<h3>5 - Problema del Movimento</h3>
    <h4>Il problema della navigazione: <br>
        <p>Uso di un sistema di coordinate  o  boundary walker che raggiunge gli angoli rilevando il contatto con i muri?</p>
    </h4>
<p>La disposizione specifica delle zone INDOOR, PLASTICBOX, GLASSBOX e HOME, insieme alla presenza di un sonar o sensore di impatto sul robot, 
consente di adottare una soluzione che non richiede l'uso di coordinate. Il robot può spostarsi all'interno dell'area di servizio lungo le pareti, 
utilizzando la rilevazione delle collisioni con le pareti per orientarsi.</p>

<p>Nella sezione seguente, esaminiamo i vantaggi dell'utilizzo di un sistema basato su coordinate e di uno senza coordinate:</p>

<ul>Vantaggi dell'utilizzo di un sistema basato su coordinate:</ul>

<li>Maggiore flessibilità: Un sistema basato su coordinate offre maggiore flessibilità nel gestire la posizione dei siti. 
Ad esempio, può adattarsi facilmente se i siti non sono più posizionati agli angoli, se il robot deve seguire un percorso ottimale o se ci sono ostacoli nell'area di servizio.</li>

<li>Potenziale riutilizzo di moduli esistenti: Utilizzando un sistema basato su coordinate, è possibile sfruttare moduli sviluppati precedentemente come mapper e planner, 
evitando la necessità di sviluppare nuove soluzioni da zero.</li>

<ul>Vantaggi dell'utilizzo di un sistema senza coordinate:</ul>

<li>Minor complessità e costo inferiore: L'assenza di un sistema basato su coordinate semplifica il design complessivo e riduce i costi associati all'implementazione.</li>

<li>Maggiore velocità di spostamento e reattività: Senza la necessità di completare passi specifici, un sistema senza coordinate consente movimenti più rapidi e una maggiore reattività ai comandi di arresto durante il movimento in avanti.</li>
<li> I robot reali potrebbero beneficiare di un sistema senza coordinate, in quanto non richiede l'uso di sistemi di feedback o hardware aggiuntivo per controllare i propri spostamenti in modo più preciso. A differenza di una soluzione basata su coordinate, un sistema basato sulla rilevazione di contatti con le pareti non è soggetto all'accumulo di errori ad ogni passo.</li>

<p>Dopo un'attenta analisi delle diverse opzioni presentate già nello <a href="../../Sprint-0/userDocs/Sprint0-LLA.html#DepositAction">Sprint0</a> , abbiamo scelto di adottare una soluzione senza l'uso di coordinate, basandoci esclusivamente su una FSM (Finite State Machine), considerando l'importanza e la rilevanza di tale decisione.</p>



    <h4>PUNTO 5C : <br>
        <p>
		Il <b>WasteService</b> può ricevere e gestire una richiesta alla volta mentre il <b>TransportTrolley</b> è abilitato a gestire più richieste di scarico ed è abilitato 
		a fare questo tramite la gestione di una coda. Il <b>WasteService</b> può gestire le richieste mentre il <b>TransportTrolley</b> è ancora occupato a gestire l'azione 
		di carico/scarico.
		
		Vantaggi e Svantaggi di far girare il robot all'indietro (percorso a rovescio o facendolo ritornare alla HOME e ripartire )
		
		
		c.	Può ricevere richieste mentre sta scaricando (2 modi) 
				i.	Facendolo girare in dietro vs passa per la home (analizzaimo entrambi e possiamo implementare entrambi, configurabile)</p>
    </h4>





	<h3>6 - Interazione TT e BasicRobot22</h3>








        <br>
        <br>
        <br>
        <br>
        <h3></h3>
<h3>Wasteservice</h3>

    <h4>Quando rispondere allo <b>Smart device</b>?</h4>
    <p>Siccome i requisiti aggiuntivi dicono che sarebbe bene mandare via il <b>Waste-truck</b> appena possibile, se una richiesta può essere soddisfatta il driver deve essere liberato subito dopo 
	   il <b>Pickup</b> (inviando allo <b>Smart device</b> una <b>loadaccept</b>). 
       Se invece la richiesta effettuata non può essere soddisfatta, è bene rispondere immediatamente con una <b>loadrejected</b> (qualunque cosa stia facendo il robot in quel momento).</p>

    <h3>Transport trolley</h3>

        <h4 id="DDR_robot_vs_Transport_trolley"><u>DDR robot</u> vs <u>Transport trolley</u>:</h4>
    <ul>
        <p>Possibile una separazione dei due concetti: </p>
        <li>
            Il termine "DDR - Differential Drive Robot" rappresenta la tecnologia con la quale il robot si muove. Il <b>DDR robot</b> è quindi una entità di basso livello che riceve comandi base 
			come "avanti", "destra", "sinistra", "halt", ecc.. <br>
         <p>Nel seguente file la documentazione completa: <c><a target="_blank" href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2022/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/BasicRobot22.html">BasicRobot22</a></c>.
		    E un suo modello eseguibile <a href="https://github.com/anatali/issLab2022/blob/main/unibo.basicrobot22/src/basicrobot.qak">basicrobot.qak</a></p>, che infatti riceve comandi:
            <pre><code>
//MOVE =  w | a | s | d | h | l | r

Dispatch cmd           : cmd(MOVE)
            </code></pre>

        </li>
        <li>
            Invece il <b>Transport trolley</b> è concepita come entità astratta di più alto livello che si occuperà di ricevere la destinazione generica<br>
            <pre><code>
//POSITION =  INDOOR | PLASTICBOX | GLASSBOX | HOME
Request moveto         : moveto(POSITION)
Reply   movetoanswer   : movetoanswer(RESULT)
            </code></pre>
        </li>
    </ul>
    <p>IN CHE MODO COMUNICANO WASTE SERVICE e TT?? 
	Noi sappiamo che sono nello stesso contesto.......COME LI GESTIAMO?</p>

    <h4>Dove collocare <b>Transport trolley</b>:</h4>
    Abbiamo identificato 3 contesti - Waste Service e TT stanno nello stesso contesto (ctxwasteservice) e comunicano con il BasicRobot che si trova in un altro contesto (ctxddrobot) 
    <img class="centerimg" style="width: 800px;" src="./img/LogicalArch_sprint1.png"/>
    <p style="width: 100%; text-align: right;"><a href="../../Sprint-0/userDocs/img/Legenda.png">Legenda.png</a></p>

    <h4>Operazioni eseguite dal <b>Transport trolley</b>:</h4>
<br>
<br>
<br>
<br>
<br>
    <p>L'interfaccia del transporttrolley risulta quindi essere la seguente:</p>
    <code><pre>
System transporttrolley

//Req from WasteService
Request pickupReq : pickupReq(ID, T)	//Richiesta di pickup di un relativo materiale
Reply pickupOk : pickupOk(ID)			//Risposta di fine pickup, relativa ad una richiesta
	
//To BasicRobot22
Dispatch cmd : cmd(MOVE)

//To Led
Event robotStateEvent : robotStateEvent(STATE)		//STATE : atHome, moving, stopped
	

Context ctxwasteservice ip[host="loaclhost" port=8072]</pre>
    </code>
    Si veda il file <a target="_blank" href="https://github.com/LucaLand/WasteService22-LLA/blob/dev/sprint-0/Sprint-0/Qak_Models/TransportTrolley.qak"> Metamodello QAK TransportTrolley</a></b>.


    <div class="remark" style="background-color: #c3fbe8;">
        <h3>Riassunto situazione attuale:</h3>
        <h4>Architettura logica:</h4>
        <img src="./img/Logical_Architecture_complete_v2.png" alt="General Logical Architecture">
		<p style="width: 100%; text-align: right;"><a href="../../Sprint-0/userDocs/img/Legenda.png">Legenda.png</a></p>
        <h4>QAK</h4>
        <a href="https://github.com/LucaLand/WasteService22-LLA/blob/dev/sprint-0/Sprint-0/Logical_Architecture_QAK/src/Logical_Architecture_Local.qak">Modello del sistema QAK</a> <br>
        <a href="https://github.com/LucaLand/WasteService22-LLA/blob/dev/sprint-0/Sprint-0/Qak_Models/WasteService.qak">Primo metamodello QAK <i>wasteservice</i></a> <small>(= a sprint0)</small><br>
        <a href="https://github.com/LucaLand/WasteService22-LLA/blob/dev/sprint-0/Sprint-0/Qak_Models/TransportTrolley.qak">Primo metamodello QAK <i>transporttrolley</i></a> <br>


    </div>

</div>


<!-- FOOTER -->
<br><br>
<div style="background-color:rgba(86, 56, 253, 0.9); width:100%; height: 28vw; text-align:left; color:white;">
    <p style="text-align: center; font-size: 12pt;">Studenti: Luca Landolfi, Antonio Franzese, Luca De Risi</p>
    <p style="text-align: center; font-size: 12pt;">Email: luca.landolfi3@studio.unibo.it,  antonio.franzese4@studio.unibo.it, luca.derisi@studio.unibo.it;</p>
    <div style="display: block; margin: 0 15vw;">
        <img src="./img/img_luca.png"   style="float: left; width: 19vw; height: 20vw">
        <img src="./img/img_anto.jpg"   style="float: left; width: 19vw; height: 20vw">
        <img src="./img/img_lude.JPG"   style="float: left; width: 22vw; height: 20vw">
    </div>
</div>

</body>
</html>
