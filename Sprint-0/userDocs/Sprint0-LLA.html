<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="it">

<!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->


<head>
    <title>Iss2023-LLA-Sprint 0</title>
    <link href="defaultStyle.css" rel="stylesheet">
    <style>
        body {
            margin-left: 30px;
            margin-right: 30px;
            font-size: 0.85em;
        }

        p {
            font-family: Tahoma,serif;
            font-size: 0.85em;
        }

        a, a:visited, a:active, a:link, a:hover {
            text-decoration: underline;
            color: #545454;
            background-color: transparent;
            font-size: 93%;
        }

        a:hover {
            background-color: #cccccc;
        }

        hr {
            clear: both;
            height: 1px;
            color: #242424;
            background-color: transparent;
        }

        h1, h2, h3 {
            color: #242424;
            clear: left;
            font: 100% Tahoma, Helvetica, Arial, sans-serif;
            margin-bottom: 0.5em;
            border-radius: 10px;
            padding: 5px;
        }

        #top {
            width: 100%;
        }


        #i {
            color: #ff1010;
        }

        tt {
            font-family: "Arial",serif;
            font-size: 90%;
            color: #006600;
        }

        em {
            font-family: "Arial",serif;
            font-size: 80%;
            font-weight: bold;
            border-style: solid;
            border-color: #abe876;
            color: #1632cc;
        }

        bc {
            font-family: "Arial",serif;
            font-size: 90%;
            font-weight: bold;
            color: #990000;
            background-color: #fcf8c7;
        }

        ks {
            font-family: "Arial",serif;
            font-weight: bold;
            color: #0000CD;
            font-size: 90%;
        }

        kc {
            font-family: "Arial",serif;
            font-weight: bold;
            color: #008000;
            font-size: 90%;
        }

        pre {
            font-family: "Consolas", co,serif;
            font-size: 15px;
            background-color: #f5f5f5;
            border: 2px solid silver;
            padding: 1px;
        }

        m {
            font-family: "Helvetica",serif;
            line-height: 100%;
            font-size: 75%;
        }

        div.body {
            font-size: 1.3em;
        }

        k {
            color: #990000;
            font-weight: bold;
            font-size: 90%;
            display: block;
        }

        h1 {
            font-size: 150%;
            background-color: #b2c0ff;
            padding: 10px;
        }

        h2 {
            background-color: #9ed8ff;
            font-size: 130%;
        }

        h3 {
            /*background-color: #e6ccff;*/
            background-color: lightblue;
            font-size: 100%;
            /*color: white;*/
            /*font-weight: bold;*/
        }

        h4 {
            background-color: #ccffcc;
            font-size: 100%;
            width: 95%;
            border-radius: 5px;
            padding: 2px;
        }

        h5 {
            background-color: #d5ffb0;
            font-size: 100%;
        }

        div.req {
            background-color: #d9ffb3;
            font-size: 18px;
            width: 700px;
            border: 3px solid green;
            padding: 15px;
            margin: 10px;
        }

        div.remark {
            background-color: #E3F2FD;
            border: 2px solid #d5f2ed;
            padding: 15px;
            margin: 10px;
            border-radius: 25px;
        }

        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }

        ol, ul, li {
            margin: 0;
            margin-left: 10px;
            padding: 0;
            padding-bottom: 5px;
        }

        table, th, td {
            border: 1px solid black;
        }

        img {
            border: 3px solid #d5f2ed;
            background-color: white;
            padding: 5px;
            width: 60%;
            margin: auto;
            display: block;
        }

        a, a:visited, a:active, a:link, a:hover {
            text-decoration: underline;
            color: #545454;
            background-color: transparent;
        }

        div.wrapdesc {
            width: 90%;
            margin: auto;
        }

        div.imagedesc {
            width: 85%;
            margin: auto;
        }

        def {
            display: block;
            margin: 1px 10px;
        }

        dt {
            font-style: italic;
            font-size: 20pt;
            margin: 10px 0;
        }

        r {
            font-style: italic;
            /*font-weight: bold;*/
            color: blue;
        }

        r2 {
            /*font-style: italic;*/
            /*font-weight: bold;*/
            color: blue;
        }

        c {
            font-style: italic;
            color: grey;
        }
    </style>
</head>


<body>
<div id="top">
<h1>Progetto Finale ISS - Waste Service</h1>
</div>
<div class="body">
<h2>Introduction</h2>
<div class="remark">
<p>Progetto finale di ISS che consiste nel realizzare un sistema di gestione dei rifiuti in cui un robot svolge il compito di trasportare i materiali dal camion ai relativi contenitori di smistamento. Attualmente, ci concentriamo su una fase preliminare di analisi dei requisiti, che consiste nel comprendere le esigenze del cliente e tradurle in una forma formalizzata e strutturata.</p>

</div>
<h2>Requirements</h2>
<div class="remark">
<p>Si riporta la pagina di requisiti del committente: <a target="_blank" href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2022/blob/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/TemaFinale22.html">Waste Service 22.pdf</a></p>
</div>

<!----------------------- REQUIREMENT ANALYSIS --------------------------->

<h2>Introduzione - QActor Metalanguage (QAK)</h2>
<div class="remark">
<!--<h3>Da fare:</h3> -->
<!--<ul>-->
<!--<li><k><del>INTRODUZIONE AL QAK</del> (+ FARE DOCUMENTO) <a target="_blank" href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2022/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/QakIntro.html">Documento QAK</a></k></li>-->
<!--<li><k>FARE UN DOCUIMENTO DI RIASSUNTO PER IL DDR E IL WENV22?</k></li>-->
<!--</ul>-->
<!--<h3>Introduzione - QActorl Metalanguage (Qak)</h3>-->
<p>Nella seguente analisi dei requisiti è risultato necessario l'utilizzo di un modello di formalizzazione che permettesse la definizione di eventi, scambio di messaggi e componenti distribuiti.
La volontà d'isolamento dei componenti e i vantaggi dell'interazioni asincrone e basate su messaggi,
siccome i linguaggi popolari come Java o altri esempi non consentono l'astrazione di questi concetti in maniera semplice e intuitiva, si farà riferimento al linguaggio e metamodello <r>QAK</r> basato su un paradigma ad attori.
Il <r>QAK</r> permette la definizione in poche semplici istruzioni di attori e macchine a stati finiti con una semantica a scambio di messaggi. In allegato la documentazione che lo riguarda <a target="_blank" href="./QAK.html">QAK-Document</a></p>
</div>
<h2>Requirement analysis</h2>
    <div class="remark">
		<h3>Service Area (<r2>SA</r2>)</h3>
        <p>Area rettangolare priva di ostacoli, che viene formalizzata con la definizione di un rettangolo.</p>
        <p>Nella <r>Service Area</r> si identificano 4 posizioni:</p> <!--: Indoor, PlasitcBox, GlassBlox e Home.</p> -->
        <ul>
            <li>Indoor</li>
            <li>Plastic Box</li>
            <li>Glass Box</li>
            <li>Home</li>
        </ul>
        <p>Le misure della <r>ServiceArea</r> si suppongono note, in quanto il committente specifica la possibilità di misurazione della stanza.</p>
        <p>Dunque nel seguente documento si farà riferimento alle misure della stanza come note denominandole "X" e "Y", rispettivamente per il lato orizzontale e verticale della <r>SA</r>.</p>
        <p class="remark">Nel caso comunque non fosse possibile reperire le misure sarà possibile utilizzare il Software fornito dalla nostra <i>SoftwareHouse</i> per la misurazione della stanza con l'utilizzo del solo <r>DDR Robot</r>
            Si riporta il documento: <a target="_blank" href="">basicRobot22/BoundaryWalker</a>.
        <p>
        <k>INSERIRE RIFERIMENTO CalcolatorePerimetro</k>
        <pre><code>
    Rectangle (x, y)
        x: Lunghezza
        y: Altezza
        </code></pre>
        <pre><code>
    Enum Position = {Indoor, PlasticBox, GlassBox, Home}
        </code></pre>
        <img src="./img/Rettangolo-ServiceArea3.png" style="width: 30%" alt="ServiceArea Rectangle (x,y)">

        <br>
        <br>

    <!------------------------ ------------------------>
        <h3>MaxGB, MaxPB</h3>
        <p><i>MaxGB</i> è la capacità massima relativa al GlassBox.</p>
        <p><i>MaxPB</i> è la capacità massima relativa al PlasticBox.</p>

        <p>Entrambe formalizzate come segue:</p>
        <pre><code>
    val MAXGB : Float
        </code></pre>
        <pre><code>
    val MAXPB : Float
        </code></pre>

        <p>Per il monitoraggio della capienza corrente formalizziamo le seguenti variabili:</p>
        <pre><code>
    var contGB : Float
        </code></pre>
        <pre><code>
    var contPB : Float
        </code></pre>

<br>
    <!------------------------ ------------------------>
        <h3>DDR Robot</h3>
        <p>Come <r>DDR Robot</r> si intende un <i>Differential Drive Robot</i> la quale documentazione è disponibile nel documento seguente, fornito dalla nostra SoftwareHouse: <a target="_blank" href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2022/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/VirtualRobot.html">VirtualRobot.html</a></p>
        <p>Non avendo a disposizione un <r>DDR Robot</r> fisico e considerando i tempi, i costi di realizzazione del robot e la necessità di effettuare test
            del <i>Software</i>, viene messo a disposizione, dalla nostra <i>SoftwareHouse</i>, un simulatore virtuale del <r>DDR Robot</r>: il <i><a target="_blank" href="">"Wenv22-VirtualRobot</a></i>.</p>
        <p>Questo simula in ambiente virtuale, le caratteristiche principali e i comportamenti del <r>DDR</r> permettendo il testing e la simulazione della nostra architettura come su un <r>DDR</r> fisico.</p>
        <p>Essendo il <i><b>Wenv22</b></i> un simulatore di un <r>DDR</r> fisico, anche nelle sue interaizoni, d'ora in poi ci riferiremo semplicemente
            al <r>DDR</r> senza specificare se <i>Simulato</i> o <i>Fisico</i>, in quanto l'interazione non cambia.</p>
<!--        <k>Spiegare perché utilizziamo il VirtualRobot fornito dall'azienda e quali sono i vantaggi (temporali)</k><br> -->
<!--        <k><ul>-->
<!--            FORMALIZZAZIONE:-->
<!--            <li>Il <r>DDR Robot</r> è il robot fisico che muoviamo simulandolo con il Wenv22 e utilizzando il software fornito per il movimento (BasicRobot)</li>-->
<!--            <li>Il <r>TransportTrolley</r> è invece l'astrazione Software nel nostro sistema che invia i messaggi al BasicRobot/Wenv22/DDRR -> Il <r>TransportTrolley</r> muove il <r>DDR Robot</r> virtuale</li>-->
<!--            <li>Il DDR riceve i messaggi di comando</li>-->
<!--        </ul></k>-->
        <p>Il <r>DDR</r> verrà dunque inteso come un <u>componente fisico del sistema con il quale la nostra architettura <i>Software</i> interagirà</u>.</p>
        <p>Facendo riferimento ai componenti già in nostro possesso, la gestione del <r>DDR</r> avverrà attraverso il componente <c><a target="_blank" href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2022/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/BasicRobot22.html">BasicRobot22</a></c>.</p>
        <p>Dunque nella nostra archietettura inseriremo il componente <c>BasicRobot22</c> con il quale interagiremo per il controllo del <r>DDR</r>.
             Astraiamo dunque il <r>DDR</r> tramite il <c>BasicRobot22</c></p>
        <k>? Possiamo rappresentare il DDR come il BasicRobot22 (non credo, sarebbe sbagliato)?</k>
        <p>Definiamo in breve il <c>BasicRobot22</c>:</p>
        <ul>
            <li>Esegue comandi-base di spostamento, con argomento:<pre><code> MOVE = w | s | l | r | h </code></pre> </li>
            <li>Permette l'esecuzione di <i>step</i>, rispondendo con <b>stepdone</b> o <b>stepfail</b></li>
            <li>È in grado di utilizzare diversi tipi di robot (virtuali e reali) costruiti ciascuno con una propria tecnologia</li>
            <li>È in grado di percepire e gestire informazioni provenienti dall’ambiente</li>
            <li>È in grado di utilizzare diversi tipi di robot (virtuali e reali) costruiti ciascuno con una propria tecnologia(<b>RIPETITIVO DA TOGLIERE</b>)</li>
        </ul>
        <p>Nel seguente documente la documentaizone completa: <c><a target="_blank" href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2022/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/BasicRobot22.html">BasicRobot22</a></c></p>
<!--        <k>- Link al BasicRobot22</k>-->
<!--        <k>Studiare BasicRobot 22 e scrivere una piccola parte di come formalizziamo il <r>DDR</r> attraveros il <c>BasicRobot</c></k>-->
        <br>
        <k>Inserire Schema con attore e messaggi + formalizzare i messaggi inviati tra i due (Transport trolley al DDR)</k>

<br>
        <h3>Transport Trolley (<r2>TT</r2>)</h3>
        <p>Fisicamente è formalizzato come un quadrato di dimensione RD.</p>

        <pre><code>
    val RD : float
        </code></pre>
        <pre><code>
    Square: (l*l)
        l= RD
        </code></pre>
        <img src="./img/Quadrato-TransportTrolley.png" alt="Quadrato di lato RD" style="width: 15%">

        <k>Formalizzazione a stati finiti</k>
		
	<pre><code>
QActor transporttrolley context ctxwasteservice {
	[#
		val name = "TransportTrolley"
		var materialType = ""	
	#]


	State s0 initial{
	<b>...</b>
	}
	Goto waiting


	State waiting {
	<b>...</b>
	}
	Transition t0 whenRequest pickupReq -> pickup


	State pickup {
	<b>...</b>
		}
		
	<b>...</b>
	}
	Goto depositPlastic if[# materialType == "plastic" #] else depositGlass

	State depositPlastic {
	<b>...</b>
	}
	Goto goHome
	//Transition t1 whenRequest pickupReq -> pickup(from PB)

	State depositGlass {
	<b>...</b>
	}
	Goto goHome
	//Transition t2 whenRequest pickupReq -> pickup(form GB)

	State goHome {
	<b>...</b>
	}
	Goto waiting

	}


//RequestHandlerActor 1-TT 
QActor depositrequesthandler context ctxwasteservice{
	[# 	var accepted = false; 
		val name = "RequestHandler"
		
		var T = ""
		var ID = 0
	#]
	State s0 initial {
	<b>...</b>
	}
	Goto waiting

	State waiting{
	<b>...</b>
	}
	Transition t0 whenTime 7000 -> requestHandling

	State requestHandling {
	<b>...</b>
	<b>...</b>
	}
	Goto requestAccepted if[# accepted == true #] else requestRejected 

	State requestAccepted {
	<b>...</b>
	}
	Goto pickingUp

	State requestRejected {
	<b>...</b>
	}
	Goto waiting

	State pickingUp {
	<b>...</b>
	}
	Transition t1 whenReply pickupOk -> waiting

	State pickupOk {
	<b>...</b>
		}
	}
	</code></pre>
	
	<p><a target="_blank" href="../transportTrolley_qak\src\it\unibo\transporttrolley/Transporttrolley.kt"> Metamodello QAK transporttrolley</a></p><br>

	<!------------------------ ------------------------>

        <h3>Deposit Action</h3>
        <p>La <i>Deposit Action</i> è definita come una sequenza di posizioni in cui il <r>TT</r> deve deve raggiungere:</p>
        <ol>
            <li>Indoor</li>
            <li>PlasticBox/GlassBox</li>
            <li>Home</li>
        </ol>

        <p>La <i>Deposit Action</i> è definita dunque come una sequenza di percorsi del <i>TransportTrolley</i>:</p>
        <ul>
            <li>Home -> Indoor</li>
            <li>Indoor -> PlasticBox/GlassBox</li>
            <li>PlasticBox/GlassBox -> Home</li>
        </ul>

        <pre><code>
    Enum TTRoutes = {HI, IP, IG, PH, GH}
        </code></pre>
        <img src="img/ServiceAreaPosition-Routes.png" alt="">

        <p>Visto il requisito <i><b>"Il WasteSerice potrebbe ricevere un nuova richiesta mentre sta ancora eseguendo la deposit action di quella precedente."</b></i>.
            Volendo far tornare indietro il robot per eseguire il prossimo scarico il prima possibile,
            il percorso può evolvere con queste aggiunte:</p>
        <p></p>
        <k>E' SPIEGATO BENE?</k>
        <ul>
            <li>Home/PB/GB -> Indoor</li>
            <li>Indoor -> PlasticBox/GlassBox</li>
            <li>PlasticBox/GlassBox -> Indoor/Home</li>
        </ul>

        <pre><code>
    Enum TTRoutes = {HI, IP, IG, PH, GH, <r>PI, GI</r>}
        </code></pre>
        <img src="img/ServiceAreaPosition-Routes2.png" alt="">


        <p>Date le seguenti informazioni:</p>
        <ul>
            <li><r>Service Aera</r> è rettangolare e priva di ostacoli</li>
            <li>Il <r>TT</r> è dotato di un sonar on-board utilizzabile per le collisioni</li>
            <li>Il Software per il movimento del nostro <r>DDR Robot</r> permette la rotazione 90°</li>
        </ul>
        <p>Il percorso ottimale utilizzabile è quello fatto percorrendo il perimetro della stanza. Con la seguente formalizzazione.</p>

        <k>SPIEGARE MEGLIO il perché</k>

        <pre><code>
    Enum TTRoutes = {HI, IP, PI, PH, PG, GP, GH}
        </code></pre>
        <img src="img/ServiceAreaPosition-Routes3.png" alt="">

<br>
    <!------------------------ ------------------------>

        <h3>Led</h3>
        <p>Strumento connesso in output al componente RaspberryPI esterno al <r>DDR Robot</r>.</p>
        <ul>Individuiamo e definiamo TRE modalità:
            <li>LedOff: quando il TT è in HOME</li>
            <li>LedOn: quando il TT è fermo</li>
            <li>LedBlink: quando il TT è in movimento, o sta scaricando/caricando materiale</li>
        </ul>
        <pre><code>
    enum LedState = {LedOff, LedOn, LedBlink};
        </code></pre>

        <p>Il committente fornisce già del software relativo al led in <b>it.unibo.radarSystem22.domain</b>, e in <b>unibo.ledqak22</b>.
            L’interazione tra <b>WasteService</b> e <b>Raspberry</b> avviene mediante un attore che si occuperà di
            ricevere il segnale in input ed emetterà un evento per il comportamento del led.
        </p>
        <k>INSERIRE I LINK dei componenti software del Sonar</k>
		
	<pre><code>
QActor led context ctxRaspberry {
	[#
		val name = "LedActor"	
	#]
	
	State off initial{
	<b>...</b>
	}
	Transition t0 whenEvent robotMoving -> blink
	
	State on {
	<b>...</b>
	}
	Transition t3 whenEvent robotMoving -> blink
	
	State blink {
	<b>...</b>
	}
	Transition t1 whenEvent robotAtHome -> off
				  whenEvent robotStopped -> on
	
	}
	</code></pre>
	
	<p><a target="_blank" href="../RaspberryCtx_QAK\src\it\unibo\led/Led.kt"> Metamodello QAK Led</a></p><br>

        <br>
    <!------------------------ ------------------------>

        <h3>Sonar</h3>
        <p>Strumento connesso in input al componente RaspberryPI esterno al <r>DDR Robot</r>.</p>

        <p>Il software relativo al sonar è fornito dal committente in <b>unibo.basicrobot22,
            it.unibo.radarSystem22.domain,
            unibo.sonarqak22</b>.</p>
        <p>Un attore emetterà eventi a seconda della distanza rilevata dal sonar e manda comandi al sonar.</p>

        <k>------------------------</k>

        <ul>QUALI SONO GLI EVENTI?
            <li> (activateSonar)??</li>
            <li> (deactivateSonar)??</li>
            <li> ()??</li>
        </ul>

        <pre><code>
    Send    (activateSonar)		: 	-
    Send    (deactivateSonar)   :	-
                :	-
    </code></pre>
	
	<pre><code>
QActor sonar context ctxRaspberry {
	[#
		val name = "SonarActor"	
	#]

	State s0 initial {
	<b>...</b>
	}

	}
	</code></pre>

<p>Sonar Qak già implementato ----> credo che sia già stato fatto qui Nel package unibo.actor22.events della directory test del progetto unibo.actor22, riportiamo la classe SonarActor22 
che definisce il Sonar come un attore proattivo e reattivo.
<p><a target="_blank" href="C:/Users/LucaD/Desktop/ISS-Final-Proj-main/docs_prof/html/SonarObservable.html?highlight=sonar#il-sonar-come-attore-che-emette-eventi"> Metamodello QAK Sonar</a></p><br>
</p>

    <!------------------------ ------------------------>

        <h3>DLimit</h3>
        <p> Distanza limite relativa al <r>Sonar</r> espressa in numero decimale.</p>
        <pre><code>
    val DLIMIT	:	Float
        </code></pre>

        <p>Se la distanza corrente misurata dal Sonar è ≤ DLIMT, il robot deve fermarsi. Quando la distanza corrente è > DLIMIT il robot è libero di muoversi.
            Definiamo la costante <b>DLIMIT</b>:</p>

        <ul>Più precisamente, quello che ci si aspetta quando la distanza diventa ≤ DLIMT, è che:
            <li>Se il robot si sta muovendo esso si ferma. Riprenderà il moto solo quando la distanza torna > DLIMIT
            </li>
            <li>Ogni altra operazione del robot deve terminare. Una volta terminata si rimane in attesa finchè la
                distanza
                non ridiventa > DLIMIT
            </li>
        </ul>


        <ul>Il blocco del trolley in conseguenza di un ‘allarme’ individuato dal Sonar dovrebbe avvenire ‘il prima
            possibile’.
            <li>PUNTO 2 in definizione DLIMIT ... Cioè va fermato/pausa qualsiasi cosa sta facendo. Non aspettiamo che
                finisce un azione.
            </li>
        </ul>
        <br>

<br>
    <!------------------------ ------------------------>

        <h3>WasteTruck(WT)</h3>
        <p> Entità che si presenta in INDOOR e richiede lo scarico del materiale che trasporta attraverso l’uso di uno
            smart device.</p>
        <p>E' un entità esterna al sistema ma che scambia messaggi con il nostro <r>WasteService</r> per lo scarico dei rifiuti. Questo attraverso uno <i>SmartDevice</i></p>
        <p>L'interazione tra il <r>WT</r> e il <r>WS</r> è fondamentale per i requisiti forniti, per cui:</p>
        <ul>
            <li>Si formalizza l'interazione con una interazione Request/Response -> <r>WasteTruckRequest</r></li>
            <li>Si rappresenta il <r>WT</r> identificandolo con lo <i>SmartDevice</i> con un attore simulato che invia richieste</li>
        </ul>

    <!------------------------ ------------------------>


        <h3>WasteTruckRequest</h3>
        <p>WasteTruck sends a <a NAME=#wasteTruckRequest>WasteTruckRequest</a></p>
        <pre><code>
    var wasteTruckRequest: obj{
        wasteType: enum{plastic, glass};
        wasteLoad: float;
    }
        </code></pre>

        Il <b>WasteService</b> e il <b>WasteTruck</b> sono in comunicazione tramite lo <b>Smart Device</b>.
            Il conducente del <b>WasteTruck</b> effettuerà una request di deposito di materiale specificando il tipo di materiale e attenderà la risposta del <b>WasteService</b>.<br>
			<ul>
            <li>requestAccepted: richiesta accettata (quando è possibile gestirla/capacità Box non piena)</li>
            <li>requestRejected: richiesta rifiutata (quando non è possibile gestirla/capacità Box piena)</li>
			</ul>
			
	<pre>
	<code>
	Request wasteDeposit	: 	wasteDeposit(ID, Type, TruckLoad)
	Reply loadaccept	: 	loadaccept(ID)
	Reply loadrejecetd	: 	loadrejecetd(ID)
	
	Dispatch pickupOk 	: 	pickupOk(ID)
	</code>
	</pre>
	<p>Lista di comandi o messaggi utilizzati nel sistema per gestire la raccolta dei rifiuti. Ecco una breve spiegazione di ciascun comando:<br>
<ul>
<li>Request wasteDeposit: wasteDeposit(ID, Type, TruckLoad)": Questo comando indica che il mittente sta richiedendo un deposito di rifiuti. I parametri inclusi nella richiesta sono l'ID del deposito, il tipo di rifiuti e il carico del camion.</li><br>
<li>Reply loadaccept: loadaccept(ID)": Questa è una risposta positiva alla richiesta di deposito dei rifiuti. L'ID incluso nella risposta corrisponde all'ID del deposito richiesto.</li><br>
<li>Reply loadrejecetd: loadrejecetd(ID)": Questa è una risposta negativa alla richiesta di deposito dei rifiuti. Anche in questo caso, l'ID incluso nella risposta corrisponde all'ID del deposito richiesto.</li><br>
<li>Dispatch pickupOk: pickupOk(ID)": Questo comando indica che la raccolta dei rifiuti dal deposito è stata effettuata con successo. L'ID incluso nella risposta corrisponde all'ID del deposito da cui i rifiuti sono stati prelevati.</li><br>
</ul>
In sostanza, questi comandi vengono utilizzati per gestire il processo di raccolta dei rifiuti. Quando un utente richiede un deposito di rifiuti, il sistema può accettare o rifiutare la richiesta e, in caso di accettazione, notificare l'utente quando la raccolta dei rifiuti è stata effettuata con successo.</p>
<pre><code>
QActor depositrequesthandler context ctxwasteservice{
	[# 	var accepted = false; 
		val name = "RequestHandler"
	#]
	State s0 initial {
	<b>...</b>
	}
	Goto waiting
	
	State waiting{
	<b>...</b>
	}
	Transition t0 whenRequest wasteDeposit -> requestHandling
	
	State requestHandling {
	<b>...</b>
	}
	Goto requestAccepted if[# accepted == true #] else requestRejected 
	
	State requestAccepted {
	<b>...</b>
	}
	Goto pickingUp
	
	State requestRejected {
	<b>...</b>
	}
	Goto waiting
	
	State pickingUp {
	<b>...</b>
	}
	Goto waiting
}
</code></pre>

 <p><a target="_blank" href="../WasteTruckRequest_QAK/depositrequesthandler_qak/src/it/unibo/depositrequesthandler/Depositrequesthandler.kt"> Metamodello QAK depositrequesthandler</a></p>
			<br>

        <p>L’azione conseguente al meccanismo di Request/Reply è esterno al sistema.</p>

           <dd>Il committente ha specificato che sarebbe meglio mandare via il truck il prima possibile, per questo motivo
            va confermato il pickup del trolley al Waste truck driver attraverso due azioni:
            <ul><br>
                <lI><b>PickingUp</b>: muovi il trolley fino a INDOOR e raccogli il materiale</lI>
                <lI><b>DroppingOut</b>: muovi il trolley fino a uno dei due container e deposita il materiale</lI>
            </ul>

        <img src="./img/WasteTruckRequest-1.1t.png" alt="WasteTruckRequestProtocol">

<br>
    <!------------------------ ------------------------>

        <h3>Smart Device</h3>
        Il <b>WasteService</b> e il <b>WasteTruck</b> sono in comunicazione tramite lo <b>Smart Device</b>.

		<p>Lo Smart Device viene utilizzato dal driver per approcciare all'INDOOR mandando una richiesta per depositare il carico specificando il tipo di materiale e il TruckLoad.
		La richiesta da inviare è stata formalizzata precedentemente nel paragrafo relativo alla <a href=#wasteTruckRequest>WasteTruckRequest</a>.
		<pre><code>
QActor smartdevice context ctxsmartdevice{
	[# var request_ID = 0 #]
	
	State s0 initial{
	<b>...</b>
	}
	Goto idle
	
	State idle {
	<b>...</b>
	}
	Transition t0 whenTime 10000 -> truckArrived
	
	State truckArrived {
	<b>...</b>
	}
	Transition t1 	whenTime  10000 -> truckArrived
					whenReply loadaccept -> waitPickUp
					whenReply loadrejecetd -> truckGoAway
							
	State waitPickUp {
	<b>...</b>
	}
	Transition t2 whenMsg pickupOk -> truckGoAway
	
	State truckGoAway {
	<b>...</b>
		}
	Transition t3 whenTime 3000 -> idle
}
</code></pre>

	 <p><a target="_blank" href="../WasteTruckRequest_QAK\smartdevice_qak\src\it\unibo\smartdevice/Smartdevice.kt"> Metamodello QAK smartdevice</a></p>
	
		<br>
    <!------------------------ ------------------------>


        <h3>Gestione tempo di raccolta/deposito del materiale dal truck</h3>
        <dd>Il commitente precisa che il tempo di raccolta del materiale del truck è sempre limitato e prevedibile,
            mentre il tempo necessario per il deposito potrebbe essere anche alquanto lungo.

        </dd>
        <p>Significa che:</p>
        <ul>
            <li>Avremo un <code><i>PickingTime</i></code> definito</li>
            <pre><code>var pickingTime : int (seconds)</code></pre>
        </ul>

        <p>Considerazioni:Volendo gestire le azioni dei materiali attraverso messaggi, una volta arrivata la conferma dell’azione si continuerà indipendentemente dal tempo.</p>

<br>
    <!------------------------ ------------------------>


        <h3>WasteServiceStatusGUI</h3>
		</br>
        <dd>Pannello di controllo che permette al ServiceManager di monitorare:
            <ul>
                <lI>La <b>Position</b> del <b>Transport trolley</b>: <code><i>TTPosition</i></code></lI>
                <lI><b>StateTransportTrolley</b>,ossia lo stato attuale del Transport trolley: <code><i>TrasportTrolleyState</i></code></lI>
                <lI>Il peso dei rifiuti contenuti in <b>PLASTICBOX</b> e <b>GLASSBOX</b>: <code><i>CurrentPB, CurrentGB</i></code></lI>
                <lI>Lo stato del <b>LED</b>: <code><i>LedState</i></code></lI>
            </ul>
            <code>
                <pre>   enum class StateTransportTrolley { REST, MOVING, PICKINGUP, DROPPINGOUT, HALT } </pre>
                <pre>
            Position :
            TTState  :
            CurrentPB, CurrentGB :
            LedState:</pre>
            </code>
        </dd>

<br>
    <!------------------------ ------------------------>


        <h3>Gestione delle collisioni</h3>
        <dd>La gestione delle collisioni avviene attraverso un <i><b><u>sonar on-board</u></b></i> presente sul DDR.</dd>
        <p>Significa che il DDR avrà un rarard e possiamo usarlo per girare nella stanza e comprendere la posizione</p>

        <dt><b>Sonar and a LED connected to a RaspnerryPi</b></dt>


<br>
    <!------------------------ ------------------------>


        <h3>WasteService: General Architecture</h3>

    </div>

    <h2>User Stories (?Facoltative)</h2>


    <h2>Logical Architecture</h2>


    <!-- USEFUL
    <table style="width:100%" border="1">
    <tr>
    <td style="width:50%">
    </td>
    <td></td>
    </tr>
    </table>
    -->

    <br><br>
</div>

<div style="background-color:rgba(86, 56, 253, 0.9); width:100%; height: 28vw; text-align:left; color:white;">
    <p style="text-align: center; font-size: 12pt;">Studenti: Luca Landolfi, Antonio Franzese, Luca De Risi</p>
    <p style="text-align: center; font-size: 12pt;">Email: luca.landolfi3@studio.unibo.it,  antonio.franzese4@studio.unibo.it, luca.derisi@studio.unibo.it;</p>
    <div style="display: block; margin: 0 15vw;">
        <img src="./img/img_luca.png"   style="float: left; width: 19vw; height: 20vw">
        <img src="./img/img_anto.jpg"   style="float: left; width: 19vw; height: 20vw">
        <img src="./img/img_lude.JPG"   style="float: left; width: 22vw; height: 20vw">
    </div>
</div>
</body>
</html>
